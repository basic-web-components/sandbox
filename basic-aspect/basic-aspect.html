<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../BasicWebComponents/BasicWebComponents.html">

<polymer-element name="basic-aspect">
<script>
Polymer(BasicComposition.compose(
  {
    contribute: {
      // Empty aspect
    },

    ready: function() {
      if (!this.innerAspect) {
        // Is listening to polymer-ready the best way to know when our children
        // have been updated? What if someone wants to add a component at
        // run-time -- will the event fire then?
        var listener = document.addEventListener('polymer-ready', function() {
          if (!this.innerAspect) {
            // Aspect still hasn't been set.
            var defaultAspect = this._defaultAspect();
            if (defaultAspect) {
              this.innerAspect = defaultAspect;
            }
          }
          document.removeEventListener(listener);
        }.bind(this));
      }
    },

    // Return the first child with a "contribute" property.
    _defaultAspect: function() {
      var children = this.children;
      for (var i = 0, length = children.length; i < length; i++) {
        var child = children[i];
        if (child.contribute) {
          return child;
        }
      }
      return null;
    }

  },
  BasicContent,
  BasicWebComponents.Aspect
));
</script>
</polymer-element>
